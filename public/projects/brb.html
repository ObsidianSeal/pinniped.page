<!DOCTYPE html>

<html lang="en">
	<head>
		<title>Bus Ride Bingo</title>

		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#4ecdc4" />

		<link rel="icon" href="../images/icon.png" />

		<script src="https://kit.fontawesome.com/c6ef7d4818.js" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>

		<meta property="og:url" content="https://pinniped.page/projects/brb" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="Bus Ride Bingo" />
		<meta property="og:description" content="Play bus-related bingo with friends while on the bus." />
		<meta property="og:image" content="https://pinniped.page/images/icon.png" />

		<meta name="description" content="Play bus-related bingo with friends while on the bus." />
		<meta name="keywords" content="pinniped.page, obsidian_seal, bus, bingo, game, transit, friends, fun" />

		<style>
			/* TYPE */

			@import url("https://fonts.googleapis.com/css2?family=Dosis:wght@200..800");

			/* GENERAL STYLES */

			body {
				margin: 0;
				border: 0;
				padding: 0;

				font-family: "Dosis", "Roboto", sans-serif;
				font-style: normal;
				font-weight: 400;
				font-size: 20px;
			}

			b {
				font-weight: 700;
			}

			ul {
				margin: 0 0 25px;
			}

			li::marker {
				color: grey;
			}

			a {
				color: black;

				text-decoration-line: underline;
				text-decoration-style: dashed;
				text-decoration-color: grey;
				text-decoration-skip-ink: none;
			}

			a:hover,
			a:focus {
				text-decoration-color: deeppink;
			}

			/* SPECIFIC STYLES */

			.board-container {
				display: flex;
				justify-content: center;

				user-select: none;
				-ms-user-select: none;
				-moz-user-select: none;
				-webkit-user-select: none;

				-webkit-tap-highlight-color: transparent;

				touch-action: manipulation;
			}

			.board {
				max-width: 754px;

				display: grid;
				grid-template-columns: repeat(5, 20%);
				grid-template-rows: repeat(5, 20%);

				margin: 50px;
				border: 2px solid black;

				background-color: black;
			}

			.square {
				display: flex;
				align-items: center;
				justify-content: center;

				aspect-ratio: 1;
				overflow: hidden;

				border: 2px solid black;
				padding: 10px;

				font-size: 40px;
				text-align: center;
				text-wrap-mode: wrap;
				text-wrap-style: pretty;

				background-color: white;
			}

			.square:hover {
				cursor: pointer;
			}

			.square.filled {
				background-color: yellowgreen;
			}

			.square-emoji {
				font-size: 200%;
			}

			.text {
				margin: 50px;
				max-width: 850px;
			}

			.text b:first-child {
				background-color: black;
				color: white;

				user-select: none;
				-ms-user-select: none;
				-moz-user-select: none;
				-webkit-user-select: none;

				-webkit-tap-highlight-color: transparent;
			}

			.text b:first-child:hover {
				cursor: pointer;
			}

			/* CONDITIONAL STYLES */

			@media all and (max-width: 800px) {
				.board {
					margin: 10px;
				}
			}

			@media all and (max-width: 600px) {
				.board {
					border-width: 1px;
				}

				.square {
					border-width: 1px;
					padding: 2px;
				}
			}

			@media all and (max-width: 500px) {
				.text {
					margin: 50px 20px;
				}
			}

			@media all and (prefers-reduced-motion: reduce) {
				canvas {
					display: none;
				}
			}
			@media all and (prefers-reduced-motion) {
				canvas {
					display: none;
				}
			}

			@media print {
				* {
					display: none;
				}
			}
		</style>
	</head>

	<body>
		<div class="main-panel">
			<div class="board-container">
				<div class="board">
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
					<div class="square"><div class="inner-square"></div></div>
				</div>
			</div>
			<div class="text">
				<b onclick="shrinkToFit();">&nbsp;&gt; CLICK/TAP TO AUTO-RESIZE BINGO BOARD TEXT &lt;&nbsp;</b><br /><br />
				<b>Bus Ride Bingo</b>
				<ul>
					<li>24 of 60 possible events are randomly selected (plus the free square in the centre) and used to populate this 5-by-5 bingo card</li>
					<li>click or tap on square to highlight it</li>
					<li>getting 5 in a row triggers confetti!</li>
				</ul>
				<b>Extras</b>
				<ul>
					<li>
						confetti is disabled for those who
						<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion" title="MDN > prefers-reduced-motion" target="_blank"
							>prefer reduced motion</a
						>
					</li>
					<li>confetti only appears after the first bingo</li>
					<li>reloading will generate a new board</li>
					<li>
						if you change the size of your window or your screen&rsquo;s orientation, press the &ldquo;CLICK/TAP TO AUTO-RESIZE BINGO BOARD TEXT&rdquo; button to
						automatically shrink the text in the bingo squares to fit in the squares
					</li>
				</ul>
				<b>Attribution</b>
				<ul>
					<li>confetti from <a href="https://confetti.js.org/more.html" title="tsParticles > More Examples" target="_blank">tsParticles</a></li>
					<li>
						typeset in
						<a href="https://fonts.google.com/specimen/Dosis?preview.text=hello%20from%20the%20pinniped.page" title="Google Fonts > Dosis" target="_blank"
							>Dosis</a
						>
					</li>
				</ul>
				<b>Links</b>
				<ul>
					<li><a href="../projects+.html" title="pinniped.page â€” Projects+">return to the Projects+ page</a></li>
					<li><a href="bus-data.html" title="BUS DATA">BUS DATA</a></li>
					<li><a href="../contact.html" title="pinniped.page â€” Contact">report a problem or suggest a feature</a></li>
				</ul>
				â€”<br />BRB v2.0.0 (June 9th, 2025)<br /><a href="" title="this page (click to refresh)">pinniped.page/projects/brb</a> by
				<a href="../about.html" title="pinniped.page â€” About">Obsidian_Seal</a>
			</div>
		</div>
	</body>

	<script>
		"use strict";

		// DEBUG STYLES
		const blueStyle = "background: #4ecdc4; color: black; padding: 0 5px";
		const yellowStyle = "background: #ffe66d; color: black; padding: 0 5px";
		const redStyle = "background: #ff6b6b; color: black; padding: 0 5px";
		const darkGreyStyle = "background: #949792; color: black; padding: 0 5px";
		const lightGreyStyle = "background: #d7d8cb; color: black; padding: 0 5px";

		// VERSION
		console.log(`%cBRB v2.0.0 (June 9th, 2025)`, darkGreyStyle);

		// ARRAY MIXING ALGORITHM
		function mixArray(array) {
			for (let i = 0; i < array.length; i++) {
				let randomIndex = Math.floor(Math.random() * (array.length - i)) + i;
				[array[i], array[randomIndex]] = [array[randomIndex], array[i]];
			}
			return array;
		}

		// EMOJI ISOLATING & SQUARE TEXT FORMATTING ALGORITHM
		function formatSquareText(string) {
			string =
				`<span>` +
				string.substring(0, string.lastIndexOf(" ")) +
				`</span><br /><span class="square-emoji">` +
				string.substring(string.lastIndexOf(" ") + 1) +
				`</span>`;
			return string;
		}

		// LIST OF ALL POSSIBLE BINGO BOARD SQUARES
		let squares = [
			"detour ğŸš§",
			"see or be on an articulated bus ğŸš",
			"near bus on the same route and direction ğŸš",
			"driver says something ğŸ‘¨â€ğŸ¦°",
			"front seats raised or lowered ğŸ“ˆ",
			"wheelchair or similar is on the bus ğŸ‘¨â€ğŸ¦¼",
			"driver leaves bus... ğŸ¦¶",
			"honk! ğŸ”Š",
			"someone&rsquo;s stop is missed ğŸ›‘",
			"arrive at your stop (last chance for bingo!) ğŸš",
			"someone is standing (for more than one stop) ğŸ§â€â™€ï¸",
			"go under a bridge (or through a tunnel) ğŸš‡",
			"go on a bridge ğŸŒ‰",
			"stroller ğŸ‘¶",
			"crying ğŸ˜­",
			"someone gets on/off where people normally can&rsquo;t ğŸ‘¨â€ğŸ¦¯",
			"bus goes up onto the curb ğŸ˜¯",
			"something falls on the floor ğŸ˜¬",
			"sitting at a stop... (no one getting on/off) â³",
			"someone is running for the bus! (waiting) ğŸƒâ€â™€ï¸",
			"go over or under railroad tracks ğŸš†",
			"bus only lane! ğŸš‹",
			"pass a stop with a shelter ğŸ ",
			"someone speaks in a language you don&rsquo;t ğŸ’¬",
			"skip a stop ğŸš«",
			"unnecessary stop, accidental stop request, or cord/button doesn&rsquo;t work ğŸ§ˆ",
			"door doesn&rsquo;t open or can&rsquo;t close ğŸšª",
			"5+ people board ğŸš¶â€â™‚ï¸",
			"5+ people get off ğŸš¶â€â™€ï¸",
			"people at a stop are waiting for a different bus ğŸ–",
			"driver waves at other bus driver ğŸ‘‹",
			"another bus is in the next lane (same direction) ğŸ›´",
			"someone is sitting next to you ğŸ˜",
			"see an express bus ğŸšŒ",
			"travel on a road with 4+ lanes ğŸ§ ",
			"travel on a one-way road â©",
			"hear music ğŸ¶",
			"someone&rsquo;s on the phone or talking loudly ğŸ¦œ",
			"see a taxi or mail, garbage, or recycling truck ğŸš•",
			"someone uses the bike rack ğŸš²",
			"bus kneels ğŸ§â€â™‚ï¸",
			"another bus driver/transit staff is on the bus ğŸ‘¨â€âœˆï¸",
			"someone goes out the front door ğŸ‘ ",
			"see/pass a school ğŸ«",
			"someone coughs or sneezes ğŸ™",
			"see a non-transit bus (school, intercity, etc.) ğŸ’",
			"see a city bus that isn&rsquo;t on a route ğŸ‘â€ğŸ—¨",
			"see an emergency vehicle ğŸš‘",
			"pass scanner difficulties ğŸ‘¾",
			"someone tries too hard to open the rear door ğŸ˜¡",
			"someone gives up their seat ğŸª‘",
			"someone pays with coins ğŸª™",
			"rain begins or ends while on the bus ğŸŒ§ï¸",
			"stop in a bus bay ğŸ›£ï¸",
			"bus shakes violently (significant turbulence) ğŸ«¨",
			"someone opens or closes a window ğŸªŸ",
			"see/pass a library ğŸ“š",
			"bus driver is thanked â¤ï¸",
			"transfer offered or accepted ğŸ«",
			"someone uses a transfer ğŸŸï¸",
		];
		squares = mixArray(squares);
		for (let i = 0; i < squares.length; i++) squares[i] = formatSquareText(squares[i]);
		console.log(`%c${squares.length}+1 possible squares`, lightGreyStyle);

		// PUT TEXT IN THE SQUARES
		window.addEventListener("load", () => {
			let squareIndex = 0;
			document.querySelectorAll(".inner-square").forEach((square) => {
				if (squareIndex == 12) square.innerHTML = formatSquareText(`bus moves (free space?) ğŸ‘€`);
				else square.innerHTML = squares[squareIndex];

				square.id = `${Math.floor(squareIndex / 5)},${squareIndex % 5}`;

				square.parentElement.addEventListener("click", () => {
					square.parentElement.classList.toggle("filled");

					let indices = square.id.split(",");
					board[indices[0]][indices[1]] = !board[indices[0]][indices[1]];

					checkBingo(indices);
				});

				squareIndex++;
			});
			shrinkToFit();
		});

		// CONSTANT SIZES
		const BORDER_BIG = 2;
		const BORDER_SMALL = 1;
		const PADDING_BIG = 10;
		const PADDING_SMALL = 2;
		const MAXIMUM_FONT_SIZE = 40;

		// SHRINK TO FIT
		function shrinkToFit() {
			let sizeDifference = PADDING_BIG * 2 + BORDER_BIG * 2;
			if (window.innerWidth <= 600) sizeDifference = PADDING_SMALL * 2 + BORDER_SMALL * 2;

			document.querySelectorAll(".inner-square").forEach((square) => {
				let outerRect = square.parentElement.getBoundingClientRect();
				let innerRect = square.getBoundingClientRect();

				let fontSize = MAXIMUM_FONT_SIZE;
				do {
					square.style = `font-size: ${fontSize--}px`;

					outerRect = square.parentElement.getBoundingClientRect();
					innerRect = square.getBoundingClientRect();
				} while (innerRect.height > outerRect.height - sizeDifference);
			});
		}

		// DETECT BINGO, CONFETTI
		let board = [
			[false, false, false, false, false],
			[false, false, false, false, false],
			[false, false, false, false, false],
			[false, false, false, false, false],
			[false, false, false, false, false],
		];
		let bingo = false;
		function checkBingo(indices) {
			if (bingo) return;

			if (
				(board[indices[0]][0] && board[indices[0]][1] && board[indices[0]][2] && board[indices[0]][3] && board[indices[0]][4]) ||
				(board[0][indices[1]] && board[1][indices[1]] && board[2][indices[1]] && board[3][indices[1]] && board[4][indices[1]]) ||
				(board[0][0] && board[1][1] && board[2][2] && board[3][3] && board[4][4]) ||
				(board[0][4] && board[1][3] && board[2][2] && board[3][1] && board[4][0])
			) {
				bingo = true;

				// thank you tsParticles (https://confetti.js.org/more.html)
				// --- BEGIN COPY ---
				const duration = 15 * 1000,
					animationEnd = Date.now() + duration,
					defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

				function randomInRange(min, max) {
					return Math.random() * (max - min) + min;
				}

				const interval = setInterval(function () {
					const timeLeft = animationEnd - Date.now();

					if (timeLeft <= 0) {
						return clearInterval(interval);
					}

					const particleCount = 50 * (timeLeft / duration);

					// since particles fall down, start a bit higher than random
					confetti(
						Object.assign({}, defaults, {
							particleCount,
							origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
						})
					);
					confetti(
						Object.assign({}, defaults, {
							particleCount,
							origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
						})
					);
				}, 250);
				// --- END COPY ---
			}
		}
	</script>
</html>
