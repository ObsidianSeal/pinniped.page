<!DOCTYPE html>

<html lang="en">
	<head>
		<title>Loading...</title>

		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#4ecdc4" />

		<link rel="icon" href="../images/icon.png" />

		<script src="https://kit.fontawesome.com/c6ef7d4818.js" crossorigin="anonymous"></script>

		<meta property="og:url" content="https://pinniped.page/projects/countdown" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="countdown" />
		<meta property="og:description" content="countdown" />
		<meta property="og:image" content="https://pinniped.page/images/icon.png" />

		<style>
			@import url("https://fonts.googleapis.com/css2?family=Bebas+Neue");

			* {
				margin: 0;
				border: 0;
				padding: 0;
			}

			::selection {
				background-color: #3b3b3b;
				color: #ff715b;
			}

			body {
				height: 100svh;
				background-color: #272727;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			h1 {
				font-family: "Bebas Neue";
				font-size: 100px;
				letter-spacing: 2px;
				color: #00c49a;
			}

			@media all and (max-width: 500px) {
				h1 {
					font-size: 60px;
				}
			}
		</style>
	</head>

	<body>
		<h1><i class="fa-solid fa-spinner fa-spin-pulse"></i></h1>

		<script>
			function pad(number, size) {
				number = number.toString();
				while (number.length < size) number = "0" + number;
				return number;
			}

			const query = window.location.search;
			const item = new URLSearchParams(query);
			const date = item.get("x");
			var isValid;

			if (date != null && date != "") {
				const year = parseInt(date.substring(0, 4));
				const month = parseInt(date.substring(5, 7));
				const day = parseInt(date.substring(8, 10));
				const hour = parseInt(date.substring(11, 13));
				const minute = parseInt(date.substring(14, 16));
				const second = parseInt(date.substring(17, 19));

				var countdownDate = new Date(year, month - 1, day, hour, minute, second);

				if (!(year >= 0 && month >= 0 && day >= 0 && hour >= 0 && minute >= 0 && second >= 0)) isValid = false;
				else isValid = true;
			} else {
				isValid = false;
			}

			if (isValid) var countdown = countdownDate.getTime();
			else var countdown = new Date().getTime() + 3602000;

			var x = setInterval(() => {
				var now = new Date().getTime();
				var distance = countdown - now;

				var days = Math.floor(distance / (1000 * 60 * 60 * 24));
				var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
				var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
				var seconds = Math.floor((distance % (1000 * 60)) / 1000);

				var countdownText = `${pad(days, 2)}:${pad(hours, 2)}:${pad(minutes, 2)}:${pad(seconds, 2)}`;
				document.querySelector("h1").innerHTML = countdownText;
				document.querySelector("title").innerHTML = countdownText;

				if (distance < 0) {
					clearInterval(x);
					document.querySelector("h1").innerHTML = `<i class="fa-solid fa-circle-check"></i>`;
					document.querySelector("title").innerHTML = "✔";
				}
			}, 1000);

			document.addEventListener("keydown", (e) => {
				if (e.key === "c") {
					if (document.querySelector("title").innerHTML != "Loading..." && document.querySelector("title").innerHTML != "✔") {
						navigator.clipboard.writeText(`${document.querySelector("h1").innerHTML}`);
					} else {
						navigator.clipboard.writeText(`00:00:00:00`);
					}
				}
			});
		</script>
	</body>
</html>
