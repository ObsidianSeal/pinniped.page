<!DOCTYPE html>

<html lang="en-CA">
	<head>
		<title>The Square</title>

		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#4ecdc4" />

		<link rel="icon" href="../images/icon.png" />

		<script src="https://kit.fontawesome.com/c6ef7d4818.js" crossorigin="anonymous"></script>

		<meta property="og:url" content="https://pinniped.page/projects/the-square" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="The Square" />
		<meta property="og:description" content="Interactive LEGO map; watch the YouTube video first." />
		<meta property="og:image" content="https://pinniped.page/images/icon.png" />

		<meta name="description" content="Interactive LEGO map; watch the YouTube video first." />
		<meta name="keywords" content="obsidian_seal, pinniped.page, interactive, LEGO, map, YouTube, video, Discord, bot, fun" />

		<style>
			/* FONTS */

			@font-face {
				font-family: "PP Right Slab";
				font-weight: 300;
				src: url(../files/PPRightSlab-Light.woff2);
			}
			@font-face {
				font-family: "PP Right Slab";
				font-weight: 500;
				src: url(../files/PPRightSlab-Medium.woff2);
			}
			@font-face {
				font-family: "PP Right Slab";
				font-weight: 700;
				src: url(../files/PPRightSlab-Bold.woff2);
			}

			/* SELECTION */

			::selection {
				background-color: #303030;
				color: white;
			}

			/* SCROLLBAR STYLES */

			::-webkit-scrollbar {
				background-color: black;
				width: 10px;
			}

			::-webkit-scrollbar-thumb {
				background-color: #505050;
			}

			::-webkit-scrollbar-thumb:hover {
				background-color: #a0a0a0;
			}

			/* GENERAL STYLES */

			* {
				margin: 0;
				border: 0;
				padding: 0;

				font-family: "PP Right Slab";
				font-weight: 300;
				font-size: 20px;
			}

			body,
			.space {
				overflow: hidden;
			}

			.space {
				width: 100dvw;
				height: 100dvh;

				background-image: url(../images/space.png);
				background-position: center;
				background-size: cover;

				display: grid;
				grid-template-columns: auto clamp(300px, 30%, 550px);
			}

			.square-container {
				height: 100dvh;

				display: flex;
				align-items: center;
				justify-content: center;
			}

			.square-container-inner,
			#the-square {
				width: min(100%, calc(100dvh * 16 / 9));
				height: auto;
				aspect-ratio: 16 / 9;

				position: relative;
			}

			#the-square {
				transition: transform 3s;
			}

			.sidebar-container {
				height: 100dvh;
				box-sizing: border-box;

				padding: 50px 50px 50px 0;

				display: flex;
				align-items: center;
				justify-content: center;
			}

			.sidebar {
				width: 100%;
				height: 100%;
				box-sizing: border-box;

				border: 1px solid white;
				padding: 20px;

				background-color: black;
				color: white;

				overflow-y: auto;

				z-index: 2;
			}

			h1,
			h2,
			h3,
			h4,
			h5,
			h6 {
				font-weight: 700;
				letter-spacing: 2pt;
			}

			h1 {
				font-size: 64px;
			}

			h2 {
				font-size: 32px;
			}

			h3 {
				font-size: 24px;
			}

			h4 {
				font-size: 20px;
			}

			h5,
			p,
			li,
			a {
				font-size: 16px;
			}

			h6 {
				font-size: 12px;
			}

			b {
				font-weight: 700;
			}

			a {
				text-decoration-color: #505050;
				text-decoration-skip-ink: none;
				color: white;
			}

			a:hover,
			a:focus {
				text-decoration-color: #a0a0a0;
			}

			ul {
				padding-left: 30px;
			}

			li {
				list-style-type: disc;
				width: fit-content;
			}

			li::marker {
				color: #a0a0a0;
			}

			img {
				display: block;
			}

			.photo {
				width: 100%;
				margin-top: 5px;
			}

			.region-circle {
				width: 20px;
				height: 20px;
				box-sizing: border-box;

				position: absolute;

				border: 2px solid black;
				border-radius: 10px;
			}

			.region-circle:hover {
				cursor: pointer;
			}

			.hide,
			.square-container-inner.zoomed .region-circle {
				display: none;
			}

			.region-arrow {
				width: 200px;
				height: 200px;

				position: absolute;
				top: calc(50% - 100px);
				left: calc(50% - 100px);

				color: white;
			}

			.region-arrow i {
				position: absolute;
				top: 0;
				right: 0;

				font-size: 100px;
			}

			hr {
				border-bottom: 1px solid white;
			}

			/* CONDITIONAL STYLES */

			@media print {
				* {
					display: none;
				}
			}

			@media all and (prefers-reduced-motion: reduce) {
				#the-square {
					transition: none;
				}
			}
			@media all and (prefers-reduced-motion) {
				#the-square {
					transition: none;
				}
			}

			@media all and (max-width: 1000px) {
				.sidebar-container {
					padding: 20px 20px 20px 0;
				}
			}

			@media all and (max-width: 800px) {
				.space {
					display: flex;
					flex-direction: column;
				}

				.sidebar-container {
					padding: 0;
					height: calc(100dvh - 100dvw * 9 / 16);
				}

				.sidebar {
					border: 0;
					border-top: 1px solid white;
				}
			}

			@media all and (max-width: 300px) {
				h1 {
					font-size: 48px;
				}
			}

			@media all and (max-width: 200px) {
				* {
					display: none;
				}
			}
		</style>
	</head>

	<body>
		<div class="space">
			<div class="square-container">
				<div class="square-container-inner">
					<img src="../images/the-square.png" alt="the square" title="the square" id="the-square" />
					<div class="region-arrow hide"><i class="fa-sharp fa-solid fa-arrow-down-left"></i></div>
				</div>
			</div>
			<div class="sidebar-container">
				<div class="sidebar">
					<p><a href="../projects+.html">← exit</a></p>
					<h1>The Square</h1>
					<br />
					<h6>VERY IMPORTANT LINKS</h6>
					<ul>
						<li>
							<a
								href="https://youtu.be/4Mbx4FVfqug"
								target="_blank"
								title="YouTube / &ldquo;The Square: a LEGO map you can interact with — pinniped.page/the-square&rdquo; [EXTERNAL]"
								>YouTube video</a
							>
						</li>
						<li><a href="https://pinniped.page/discord" target="_blank" title="join Seal Squad [EXTERNAL]">Discord server</a></li>
					</ul>
					<br />
					<h6>WHAT IS THIS?</h6>
					<p>
						The Square is a LEGO map that I felt like building one day. What you see on this page is its digital recreation. There are 22 uniquely coloured
						regions, each with a minifigure leader.
					</p>
					<br />
					<h6>HOW TO PARTICIPATE</h6>
					<p>
						You can &ldquo;join&rdquo; a region on
						<a href="https://pinniped.page/discord" target="_blank" title="join Seal Squad [EXTERNAL]">my Discord server (Seal Squad)</a> using
						<a href="omega-seal.html" title="Omega Seal">my Discord bot (Omega Seal)</a>. More information can be found on
						<a href="omega-seal.html" title="Omega Seal">the Omega Seal page</a>.
					</p>
					<br />
					<h6>HOW TO USE THIS PAGE</h6>
					<p>Click on the dot in the centre of a region or one of the region names in the list below to learn more about it.</p>
					<br />
					<h6>REGIONS</h6>
					<p id="region-list">I tried my best to match these colours to the official LEGO colours.</p>
					<br />
					<h6>ATTRIBUTION</h6>
					<ul>
						<li><a href="https://www.lego.com/" target="_blank" title="LEGO [EXTERNAL]">LEGO</a></li>
						<li>
							typeface:
							<a href="https://pangrampangram.com/products/right-slab" target="_blank" title="Pangram Pangram Foundry > Right Slab [EXTERNAL]"
								>PP Right Slab</a
							>
						</li>
						<li>icons from <a href="https://fontawesome.com/" target="_blank" title="Font Awesome [EXTERNAL]">Font Awesome</a></li>
						<li>
							LEGO models created in and rendered with
							<a href="https://www.bricklink.com/v3/studio/main.page" target="_blank" title="BrickLink > Studio [EXTERNAL]">BrickLink Studio</a>
						</li>
						<li>I don&rsquo;t remember where I got the LEGO colours from</li>
						<li>
							<a href="https://firebase.google.com/products/realtime-database" target="_blank" title="Firebase Realtime Database [EXTERNAL]"
								>Firebase Realtime Database</a
							>, <a href="../posts/2024-07-08.html" title="blog post — &ldquo;Costs & Limitations&rdquo;">etc.</a>
						</li>
					</ul>
					<br />
					<h6>AND AS ALWAYS...</h6>
					<ul>
						<li><a href="../projects+.html" title="pinniped.page — Projects+">more projects</a></li>
						<li><a href="../status.html" title="pinniped.page — Status">website and bot status</a></li>
						<li><a href="../contact.html" title="pinniped.page — Contact">report a problem or suggest a feature</a></li>
					</ul>
					<br />
					<h6>SOME PHOTOS OF THE REAL THING</h6>
					<img
						src="../images/the-square-real-01.jpg"
						alt="the real square, without any minifigures"
						title="the real square, without any minifigures"
						class="photo"
					/>
					<img src="../images/the-square-real-02.jpg" alt="the real square" title="the real square" class="photo" />
					<img src="../images/the-square-real-03.jpg" alt="the real square, front left focus" title="the real square, front left focus" class="photo" />
					<img src="../images/the-square-real-04.jpg" alt="the real square, back right focus" title="the real square, back right focus" class="photo" />
					<img src="../images/the-square-real-05.jpg" alt="the real square, front right focus" title="the real square, front right focus" class="photo" />
					<img
						src="../images/the-square-real-06.jpg"
						alt="the real square, closer back right focus"
						title="the real square, closer back right focus"
						class="photo"
					/>
					<img src="../images/the-square-real-07.jpg" alt="the real square, middle focus" title="the real square, middle focus" class="photo" />
					<img src="../images/the-square-real-08.jpg" alt="the real square, lower middle focus" title="the real square, lower middle focus" class="photo" />
					<img src="../images/the-square-real-09.jpg" alt="the real square, lower back right focus" title="the real square, lower back right focus" class="photo" />
					<img
						src="../images/the-square-real-10.jpg"
						alt="the real square, very close middle focus"
						title="the real square, very close middle focus"
						class="photo"
					/>
				</div>
			</div>
		</div>

		<script>
			const regions = {
				"dark-red": ["Dark Red", "#7f131b", 4540, 1570, 71, "UNKNOWN"],
				"red": ["Red", "#dd1a21", 4980, 1170, 189, "UNKNOWN"],
				"orange": ["Orange", "#f57d20", 2210, 950, 450, "UNKNOWN"],
				"dark-yellow": ["Dark Yellow", "#fbab18", 3840, 1120, 24, "UNKNOWN"],
				"yellow": ["Yellow", "#ffcd03", 3420, 1250, 241, "UNKNOWN"],
				"gold": ["Gold", "#d2a12a", 4180, 2530, 8, "UNKNOWN"],
				"lime": ["Lime", "#9aca3a", 5630, 2130, 398, "UNKNOWN"],
				"green": ["Green", "#009247", 5380, 3200, 488, "UNKNOWN"],
				"dark-green": ["Dark Green", "#004a2d", 3840, 3150, 232, "UNKNOWN"],
				"olive": ["Olive", "#6f947a", 5920, 1410, 128, "UNKNOWN"],
				"teal": ["Teal", "#189e9f", 4660, 2490, 12, "UNKNOWN"],
				"turquoise": ["Turquoise", "#00a3da", 4790, 2230, 23, "UNKNOWN"],
				"light-blue": ["Light Blue", "#78bfea", 3400, 1790, 54, "UNKNOWN"],
				"cyan": ["Cyan", "#00bed3", 4110, 2080, 132, "UNKNOWN"],
				"blue": ["Blue", "#006cb7", 2250, 2500, 1077, "UNKNOWN"],
				"dark-blue": ["Dark Blue", "#00395e", 4380, 2440, 28, "UNKNOWN"],
				"magenta": ["Magenta", "#e95da2", 3260, 840, 22, "UNKNOWN"],
				"fuchsia": ["Fuchsia", "#b51c7d", 3390, 620, 142, "UNKNOWN"],
				"pink": ["Pink", "#f6adcd", 4330, 770, 47, "UNKNOWN"],
				"lavender": ["Lavender", "#bca6d0", 4180, 620, 26, "UNKNOWN"],
				"violet": ["Violet", "#9675b4", 4990, 600, 86, "UNKNOWN"],
				"purple": ["Purple", "#4c2f92", 5760, 710, 174, "UNKNOWN"],
			};

			let totalArea = 0;
			for (let region in regions) {
				totalArea += regions[region][4];

				document.querySelector("#region-list").innerHTML =
					document.querySelector("#region-list").innerHTML +
					`<br /><i class="fa-sharp fa-solid fa-circle fa-sm" style="color: ${regions[region][1]}"></i> <a class="region-link" href="#${region}" title="learn more about ${regions[region][0]}">${regions[region][0]}</a>`;

				document.querySelector(".square-container-inner").innerHTML =
					document.querySelector(".square-container-inner").innerHTML +
					`<div class="region-circle" id="region-circle-${region}" style="top: calc(${(regions[region][3] / 4320) * 100}% - 10px); left: calc(${
						(regions[region][2] / 7680) * 100
					}% - 10px); background-color: ${regions[region][1]}" title="learn more about ${regions[region][0]}"></div>`;
			}
			// console.log(totalArea); we're 44 studs short...

			document.querySelectorAll(".region-link").forEach((link) => {
				link.addEventListener("click", () => {
					showRegionInfo(link.href.substring(link.href.indexOf("#") + 1));
				});
			});
			document.querySelectorAll(".region-circle").forEach((circle) => {
				circle.addEventListener("click", () => {
					history.replaceState(null, null, `#${circle.id.substring(14)}`);
					showRegionInfo(circle.id.substring(14));
				});
			});

			let lastScroll;
			let zoomDirection = true;
			let zoomCounts = [0, 0];
			const initialSidebarContent = document.querySelector(".sidebar").innerHTML;

			function showRegionInfo(region) {
				zoomCounts[0]++;
				let zoomNumber = zoomCounts[0];

				lastScroll = Math.round(document.querySelector(".sidebar").scrollTop);
				zoomDirection = true;

				document.querySelector(".square-container-inner").classList.add("zoomed");
				document.querySelector("#the-square").style = `transform: translateX(${((regions[region][2] - 3840) / devicePixelRatio) * -1}px) translateY(${
					((regions[region][3] - 2160) / devicePixelRatio) * -1
				}px) scale(${7680 / (document.querySelector(".square-container-inner").getBoundingClientRect().width * devicePixelRatio)})`;
				setTimeout(() => {
					if (zoomDirection && zoomCounts[0] == zoomNumber) {
						document.querySelector(".region-arrow").classList.remove("hide");
						document.querySelector(".square-container-inner").classList.add("zoomed");
					}
				}, 3000);

				document.querySelector(".sidebar").innerHTML = `<p><a id="exit" href="#" title="close region information">← back</a></p><h1>${
					regions[region][0]
				}</h1><br /><h6>COLOUR</h6><p><i class="fa-sharp fa-solid fa-circle fa-sm" style="color: ${regions[region][1]}"></i> ${
					regions[region][1]
				}</p><br /><h6>POPULATION</h6><p>${regions[region][5]}</p><br /><h6>AREA</h6><p>${regions[region][4].toLocaleString("en-CA")}±${Math.ceil(
					regions[region][4] / 100
				)} sq. studs</p><br /><h6>LEADER</h6><img src="../images/the-square-leader-${region}.jpg" alt="the leader of ${regions[region][0]}" title="the leader of ${
					regions[region][0]
				}" class="photo" /><br /><h6>JOIN COMMAND</h6><p>/join ${region}</p><br /><hr /><br /><p>Please note that commands related to The Square can only be used in <a href="https://pinniped.page/discord" target="_blank" title="join Seal Squad [EXTERNAL]">Seal Squad</a>. For more information and to make sure the bot is online, visit <a href="omega-seal.html" title="Omega Seal">the Omega Seal page</a>.</p>`;

				document.querySelector("#exit").addEventListener("click", () => {
					zoomOut();
				});
			}

			document.addEventListener("keydown", (event) => {
				if (event.key == "Escape") {
					zoomOut();
				}
			});

			function zoomOut() {
				zoomCounts[1]++;
				let zoomNumber = zoomCounts[1];
				zoomDirection = false;

				document.querySelector(".region-arrow").classList.add("hide");
				document.querySelector("#the-square").style = "";
				setTimeout(() => {
					if (!zoomDirection && zoomCounts[1] == zoomNumber) {
						document.querySelector(".square-container-inner").classList.remove("zoomed");
						document.querySelector(".region-arrow").classList.add("hide");
					}
				}, 3000);
				document.querySelector(".sidebar").innerHTML = initialSidebarContent;
				document.querySelector(".sidebar").scroll(0, lastScroll);

				document.querySelectorAll(".region-link").forEach((link) => {
					link.addEventListener("click", () => {
						showRegionInfo(link.href.substring(link.href.indexOf("#") + 1));
					});
				});
			}

			if (Object.keys(regions).includes(window.location.href.substring(window.location.href.lastIndexOf("#") + 1))) {
				showRegionInfo(window.location.href.substring(window.location.href.lastIndexOf("#") + 1));
			}
		</script>

		<script src="../files/auto-project-link-target.js" type="module"></script>
	</body>
</html>
