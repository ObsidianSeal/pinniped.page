<!DOCTYPE html>

<html lang="en-CA">
	<head>
		<title>wordlelele</title>

		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#4ecdc4" />

		<link rel="icon" href="../images/icon.png" />

		<meta property="og:url" content="https://pinniped.page/projects/w" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="wordlelele" />
		<meta property="og:description" content="Weird Wordle: longer words, choose the next word." />
		<meta property="og:image" content="https://pinniped.page/images/icon.png" />

		<meta name="description" content="Weird Wordle: longer words, choose the next word." />
		<meta name="keywords" content="wordle, wordlelele, pinniped, page, obsidian_seal, word, puzzle, custom, weird, crazy, fun, short, long, game, friends" />

		<style id="theme">
			:root {
				--c1: #252525;
				--c2: #464646;
				--c3: #7d7d7d;
				--c4: #ffffff;
				--c5: #448ccb;
				--c6: #f68e56;
			}
		</style>

		<style>
			@import url(https://use.typekit.net/rzo4wst.css);

			* {
				margin: 0;
				border: 0;
				padding: 0;
				font-family: miller-text, serif;
				font-weight: 400;
				font-style: normal;
				font-size: 24px;
			}

			::selection {
				background-color: var(--c2);
			}

			::-webkit-scrollbar {
				width: 20px;
			}

			::-webkit-scrollbar-thumb {
				background-color: var(--c2);
			}

			::-webkit-scrollbar-thumb:hover {
				background-color: var(--c3);
			}

			body {
				background-color: var(--c1);
				color: var(--c4);
				padding: 120px 0 260px;
			}

			h1 span:first-child {
				color: var(--c6);
			}

			h1 span:last-child {
				color: var(--c5);
			}

			h2 {
				font-size: 48px;
				color: var(--c6);
			}

			.question h2 {
				margin: 20px 0;
			}

			.done h2 {
				color: var(--c5);
			}

			input {
				background-color: var(--c4);
				color: var(--c1);
				caret-color: var(--c1);
				padding: 0 5px;
				width: 440px;
				text-transform: lowercase;
				border-radius: 0px;
			}

			input:focus {
				outline: none;
			}

			input::placeholder {
				color: var(--c3);
			}

			input::selection {
				color: var(--c4);
			}

			input[type="color"] {
				visibility: hidden;
				width: 100px;
				margin: 0;
				border: 0;
				padding: 0;
			}

			label {
				margin: 0;
				border: 0;
				padding: 0;
			}

			label:hover {
				cursor: pointer;
			}

			ul,
			ol {
				margin-left: 50px;
			}

			li {
				margin-top: 5px;
				width: fit-content;
			}

			li::marker {
				color: var(--c3);
			}

			li span.correct {
				background-color: var(--c5);
			}

			li span.present {
				background-color: var(--c6);
			}

			li span.absent,
			.question p span.absent {
				background-color: var(--c2);
			}

			.header,
			.guesses,
			.letters {
				user-select: none;
			}

			.header {
				background-color: var(--c1);
				width: 100%;
				height: 50px;
				display: flex;
				justify-content: center;
				align-items: center;
				border-bottom: 1px solid var(--c2);
				position: fixed;
				top: 0;
				z-index: 1;
			}

			.header p {
				position: fixed;
				text-decoration: underline;
				text-decoration-color: transparent;
				transition: text-decoration-color 0.5s;
			}

			.header p:hover,
			.header p:focus {
				cursor: pointer;
				text-decoration-color: var(--c3);
				outline: none;
			}

			/* the responsiveness of the guess squares IS MEDIOCRE */
			.guesses {
				padding: 0 10px;
			}

			.guesses h3,
			.guesses h3 d {
				font-size: 48px;
				text-align: center;
			}

			.guesses div {
				display: flex;
				justify-content: center;
				margin-top: 10px;
			}

			.guesses div div {
				width: 50px;
				height: 50px;
				margin: 0 10px 0 0;
				background-color: transparent;
				border: 2px solid var(--c2);
				font-size: 36px;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.guesses div div:last-child {
				margin: 0;
			}

			.letters {
				width: calc(100% - 20px);
				position: fixed;
				bottom: 0;
				padding: 20px 10px 30px;
				background-color: var(--c1);
				border-top: 1px solid var(--c2);
			}

			.letters div {
				display: flex;
				justify-content: center;
				margin-top: 10px;
			}

			.letters div div {
				width: 35px;
				height: 45px;
				margin: 0 10px 0 0;
				background-color: var(--c3);
				border-radius: 3px;
				font-size: 18px;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.letters div div:hover {
				cursor: pointer;
			}

			.letters div:last-child div:first-child,
			.letters div:last-child div:last-child {
				width: 58px;
			}

			.letters div div:last-child {
				margin: 0;
			}

			.question * {
				max-width: 1000px;
			}

			.question,
			.done {
				position: fixed;
				display: none;
				top: 0;
				width: calc(100% - 100px);
				height: calc(100% - 100px);
				background-color: var(--c1);
				padding: 50px;
				overflow-y: scroll;
				z-index: 2;
			}

			.question p,
			.done p {
				margin-top: 20px;
			}

			.question p:first-child,
			.done p:first-child {
				margin: 0 0 20px;
				text-decoration: underline;
				text-decoration-color: transparent;
				transition: text-decoration-color 0.5s;
				user-select: none;
				width: fit-content;
			}

			.question p:first-child:hover,
			.question p:first-child:focus,
			.done p:first-child:hover,
			.done p:first-child:focus {
				text-decoration-color: var(--c3);
				cursor: pointer;
				outline: none;
			}

			.guesses div div.active {
				border-color: var(--c3);
				animation: appear 200ms;
			}

			.guesses div div.correct,
			.letters div div.correct {
				border-color: var(--c5);
				background-color: var(--c5);
			}

			.guesses div div.present,
			.letters div div.present {
				border-color: var(--c6);
				background-color: var(--c6);
			}

			.guesses div div.absent,
			.letters div div.absent {
				border-color: var(--c2);
				background-color: var(--c2);
			}

			.show {
				display: initial;
			}

			.hide {
				display: none;
			}

			.blue {
				color: var(--c5);
			}

			.orange {
				color: var(--c6);
			}

			.grey {
				color: var(--c3);
			}

			.inline-block {
				display: inline-block;
			}

			#headerExitButton {
				left: 50px;
			}

			#headerQuestionButton {
				right: 50px;
			}

			#← {
				font-size: 30px;
			}

			#nextWordSubmit,
			#shareButton,
			#newWordButton {
				text-decoration: underline;
				text-decoration-color: transparent;
				transition: text-decoration-color 0.5s;
				user-select: none;
				display: inline-block;
			}

			#shareButton.hide,
			#newWordButton.hide {
				display: none;
			}

			#nextWordSubmit:hover,
			#shareButton:hover,
			#newWordButton:hover,
			#nextWordSubmit:focus,
			#shareButton:focus,
			#newWordButton:focus {
				cursor: pointer;
				text-decoration-color: var(--c3);
				outline: none;
			}

			#lastChangedDisplay,
			#version {
				padding: 0 6px;
			}

			#version {
				background-color: var(--c2);
				width: fit-content;
			}

			#version a {
				color: var(--c4);
				text-decoration: none;
			}

			#d1,
			#d2,
			#d3 {
				opacity: 0%;
			}

			#d1 {
				animation: d1 2.5s infinite 0.5s;
			}

			#d2 {
				animation: d2 2.5s infinite 0.5s;
			}

			#d3 {
				animation: d3 2.5s infinite 0.5s;
			}

			@keyframes appear {
				50% {
					transform: scale(1.1);
				}
			}

			@keyframes d1 {
				0% {
					opacity: 0%;
				}
				20% {
					opacity: 100%;
				}
				40% {
					opacity: 100%;
				}
				60% {
					opacity: 100%;
				}
				80% {
					opacity: 100%;
				}
				100% {
					opacity: 0%;
				}
			}

			@keyframes d2 {
				0% {
					opacity: 0%;
				}
				20% {
					opacity: 0%;
				}
				40% {
					opacity: 100%;
				}
				60% {
					opacity: 100%;
				}
				80% {
					opacity: 100%;
				}
				100% {
					opacity: 0%;
				}
			}

			@keyframes d3 {
				0% {
					opacity: 0%;
				}
				20% {
					opacity: 0%;
				}
				40% {
					opacity: 0%;
				}
				60% {
					opacity: 100%;
				}
				80% {
					opacity: 100%;
				}
				100% {
					opacity: 0%;
				}
			}

			@media all and (max-width: 550px) {
				input:not(input[type="color"]) {
					width: calc(100% - 10px);
				}

				#headerExitButton {
					left: 20px;
				}

				#headerQuestionButton {
					right: 20px;
				}
			}

			@media all and (max-width: 440px) {
				h2 {
					font-size: 36px;
				}

				#enter {
					font-size: 14px;
				}
			}

			@media all and (max-width: 330px) {
				.question,
				.done {
					width: calc(100% - 40px);
					height: calc(100% - 100px);
					padding: 50px 20px;
				}
			}

			@media all and (max-height: 440px) {
				.letters {
					padding: 0 10px 10px;
				}
			}
		</style>
	</head>

	<body class="fa-width-auto">
		<div class="header">
			<h1>wordle<span>le</span><span>le</span></h1>
			<p id="headerExitButton" tabindex="0">← exit</p>
			<p id="headerQuestionButton" tabindex="0">???</p>
		</div>

		<div class="guesses">
			<h3>Loading<d id="d1">.</d><d id="d2">.</d><d id="d3">.</d></h3>
		</div>

		<div class="letters">
			<div>
				<div id="Q">Q</div>
				<div id="W">W</div>
				<div id="E">E</div>
				<div id="R">R</div>
				<div id="T">T</div>
				<div id="Y">Y</div>
				<div id="U">U</div>
				<div id="I">I</div>
				<div id="O">O</div>
				<div id="P">P</div>
			</div>
			<div>
				<div id="A">A</div>
				<div id="S">S</div>
				<div id="D">D</div>
				<div id="F">F</div>
				<div id="G">G</div>
				<div id="H">H</div>
				<div id="J">J</div>
				<div id="K">K</div>
				<div id="L">L</div>
			</div>
			<div>
				<div id="enter">enter</div>
				<div id="Z">Z</div>
				<div id="X">X</div>
				<div id="C">C</div>
				<div id="V">V</div>
				<div id="B">B</div>
				<div id="N">N</div>
				<div id="M">M</div>
				<div id="←">←</div>
			</div>
		</div>

		<div class="question">
			<p id="questionBackButton" tabindex="0">← back</p>

			<h2>About / How to Play</h2>

			<p>
				wordlelele: it&rsquo;s Wordle, but the word can be anywhere from one to twenty letters long. And because that&rsquo;s not crazy enough, if you successfully
				figure out what the word is, YOU get to choose the next word. Unfortunately, that means there&rsquo;s no guarantee that the word is family friendly or even a
				word at all, so good luck!
			</p>

			<p>
				The current word was set <span class="absent inline-block" id="lastChangedDisplay">? days ? hours ? minutes ? seconds</span> ago.
				<span id="newWordButton" tabindex="0" class="hide">NEW WORD →</span>
			</p>

			<p>
				However long the word is, you get one more guess than there are letters in the word. To make a guess, use either the provided on-screen keyboard or your own to
				enter an appropriately long word (or random string of letters—I won&rsquo;t stop you), then press enter. The letters that make up your guess are then coloured
				based on their presence in the target word as follows:
			</p>

			<ul>
				<li><span class="correct" id="c5colour">&nbsp;BLUE&nbsp;</span> = correct!</li>
				<li><span class="present" id="c6colour">&nbsp;ORANGE&nbsp;</span> = in the target word, but elsewhere</li>
				<li><span class="absent" id="c2colour">&nbsp;GREY&nbsp;</span> = not in the target word</li>
			</ul>

			<p>
				If you successfully determine the word within the alloted number of guesses, congratulations! You can choose the next word and/or flex your luck and/or skill
				with the share button (it copies text to your clipboard). If you can&rsquo;t get the word, don&rsquo;t fret: you still get to choose the next one.
			</p>

			<h2>Frequently Asked Questions</h2>

			<ul>
				<li>Why orange and blue?<br /><span class="grey">I wanted to be different, and I personally like this colour scheme better.</span></li>
				<li>Do I have to guess real words?<br /><span class="grey">No.</span></li>
				<li>How do I know if I set the word?<br /><span class="grey">A confirmation message appears under the input field.</span></li>
				<li>
					If the target word contains a letter more than once, is that reflected by the guess highlighting?<br /><span class="grey"
						>Yes, just like how Wordle does it.</span
					>
				</li>
				<li>
					Why are the guess grid squares all squished together?<br /><span class="grey"
						>Because...I can&rsquo;t seem to control them. For words longer than five or six letters you may want to play on a bigger screen. Sorry.</span
					>
				</li>
				<li>
					Why isn&rsquo;t the guess grid showing up?<br /><span class="grey">Either your internet is slow or there&rsquo;s something wrong with the database.</span>
				</li>
				<li>
					Why is the maximum word length twenty letters?<br /><span class="grey"
						>Not only is twenty a nice round number, it&rsquo;s also the length of &ldquo;uncharacteristically&rdquo;: the longest [English] word you might
						actually use.</span
					>
				</li>
				<li>Why can&rsquo;t I make &lt;invalid word&gt; the next word?<br /><span class="grey">Because words consist exclusively of letters.</span></li>
				<li>
					Someone set the word to something offensive, and I would rather not type it in. Is there a way to report words?<br /><span class="grey"
						>Unfortunately, no. If you don&rsquo;t want to solve the puzzle, you can always just enter random letters until you run out of guesses, at which point
						you can change the word. Alternatively, send me a message on Discord and I&rsquo;ll delete the word from the database.</span
					>
				</li>
				<li>
					What do you mean by &ldquo;the word in the database was invalid&rdquo;?<br /><span class="grey"
						>Either the word contained a character that was not a letter, or no word was found. Hopefully this never happens.</span
					>
				</li>
				<li>What font is this?<br /><span class="grey">Miller Text.</span></li>
			</ul>

			<h2>Theme Editor</h2>

			<ol>
				<li>
					<label for="themeColour1" style="background-color: var(--c1)"><input type="color" id="themeColour1" value="#252525" /></label>
				</li>
				<li>
					<label for="themeColour2" style="background-color: var(--c2)"><input type="color" id="themeColour2" value="#464646" /></label>
				</li>
				<li>
					<label for="themeColour3" style="background-color: var(--c3)"><input type="color" id="themeColour3" value="#7d7d7d" /></label>
				</li>
				<li>
					<label for="themeColour4" style="background-color: var(--c4)"><input type="color" id="themeColour4" value="#ffffff" /></label>
				</li>
				<li>
					<label for="themeColour5" style="background-color: var(--c5)"><input type="color" id="themeColour5" value="#448ccb" /></label>
				</li>
				<li>
					<label for="themeColour6" style="background-color: var(--c6)"><input type="color" id="themeColour6" value="#f68e56" /></label>
				</li>
			</ol>

			<p id="version">wordlelele — a project by Obsidian_Seal</p>
		</div>

		<div class="done">
			<p id="doneActionButton" tabindex="0">done_action</p>

			<h2>done_message_title</h2>

			<p>done_message_subtitle</p>

			<p>
				Choose the next word: <input id="nextWordInput" maxlength="20" placeholder="new 1-20 letter word" autocomplete="off" />
				<span id="nextWordSubmit" tabindex="0">SUBMIT →</span>
			</p>

			<p id="nextWordStatus" class="hide"></p>

			<p id="shareButton" tabindex="0" class="hide">SHARE →</p>

			<p id="shareButtonStatus" class="blue hide">Copied!</p>
		</div>

		<script type="module">
			// 0. fireBASED
			import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
			import { getDatabase, ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

			const firebaseConfig = {
				apiKey: "AIzaSyAigBAgn7Uhybip_m3P508DIpybb2qdI5g",
				authDomain: "the-pinniped-page.firebaseapp.com",
				databaseURL: "https://the-pinniped-page.firebaseio.com",
				projectId: "the-pinniped-page",
				storageBucket: "the-pinniped-page.appspot.com",
				messagingSenderId: "636989973689",
				appId: "1:636989973689:web:6d938d9588606d803a6768",
			};
			const app = initializeApp(firebaseConfig);

			// 1: header & other "back" buttons
			function goBack() {
				console.log(document.referrer);
				if (
					document.referrer != "" &&
					document.referrer != null &&
					document.referrer != "https://pinniped.page/w" &&
					document.referrer != "https://pinniped.page/projects/w" &&
					document.referrer.includes("pinniped.page")
				)
					history.back();
				else window.location.href = "../projects+.html";
			}

			document.querySelector("#headerExitButton").addEventListener("click", (e) => {
				goBack();
			});
			document.querySelector("#headerQuestionButton").addEventListener("click", (e) => {
				document.querySelector(".question").classList.add("show");
				document.querySelector(".guesses").classList.add("hide");
			});

			document.querySelector("#questionBackButton").addEventListener("click", (e) => {
				document.querySelector(".question").classList.remove("show");
				document.querySelector(".guesses").classList.remove("hide");
			});

			// 2: guesses
			var word;
			var lastUpdated;
			var invalidWord = false;
			var letters = {
				A: 0,
				B: 0,
				C: 0,
				D: 0,
				E: 0,
				F: 0,
				G: 0,
				H: 0,
				I: 0,
				J: 0,
				K: 0,
				L: 0,
				M: 0,
				N: 0,
				O: 0,
				P: 0,
				Q: 0,
				R: 0,
				S: 0,
				T: 0,
				U: 0,
				V: 0,
				W: 0,
				X: 0,
				Y: 0,
				Z: 0,
			};

			async function loadWord() {
				const db = getDatabase();

				try {
					await get(ref(db, "wordlelele")).then((snapshot) => {
						word = snapshot.val().word.toUpperCase();
						lastUpdated = snapshot.val().lastUpdated;
					});
				} catch (error) {
					word = "X";
					invalidWord = true;
				}

				if (!/^[a-zA-Z]{1,20}$/.test(word)) {
					word = "X";
					invalidWord = true;
				}

				checkForNewWord(); // ?

				for (let i = 0; i < word.length; i++) {
					letters[word[i]]++;
				}

				document.querySelector(".guesses").innerHTML = "";

				// are the right number of attempts given? (word length + 1, also used in the title (x2))
				for (let i = 0; i < word.length + 1; i++) {
					let row = document.createElement("div");
					row.setAttribute("id", `row${i}`);

					for (let j = 0; j < word.length; j++) {
						let square = document.createElement("div");
						square.setAttribute("id", `row${i}square${j}`);
						row.appendChild(square);
					}

					document.querySelector(".guesses").appendChild(row);
				}

				document.querySelector("title").innerHTML = `wordlelele (1/${word.length + 1})`;

				document.querySelectorAll(".letters div div").forEach((button) => {
					button.addEventListener("click", (e) => {
						letterInput(button.innerHTML);
					});
				});

				var keys = {};

				document.addEventListener("keydown", (e) => {
					keys[e.key] = true;

					if (keys["Control"] === true) return; // prevent letters showing up when shortcuts used, there are probably more keys like this

					if (e.keyCode == 13) {
						if (document.activeElement == document.querySelector("#headerExitButton")) {
							goBack();
						} else if (document.activeElement == document.querySelector("#headerQuestionButton")) {
							document.querySelector(".question").classList.add("show");
							document.querySelector(".guesses").classList.add("hide");

							document.querySelector("#headerQuestionButton").blur();
						} else if (document.activeElement == document.querySelector("#questionBackButton")) {
							document.querySelector(".question").classList.remove("show");
							document.querySelector(".guesses").classList.remove("hide");
						} else letterInput("enter");
					}
					if (e.keyCode == 8) letterInput("←");
					if (e.keyCode >= 65 && e.keyCode <= 90) {
						letterInput(e.key.toUpperCase());
					}

					if (e.keyCode == 27) {
						document.querySelector(".question").classList.remove("show");
						document.querySelector(".guesses").classList.remove("hide");
					}
				});

				document.addEventListener("keyup", (e) => {
					delete keys[e.key];
				});

				// will this cause problems?
				window.addEventListener("focus", (e) => {
					keys = {};
				});
			}
			loadWord();

			// 3: letters
			var positionRow = 0;
			var positionSquare = 0;
			var done = false;
			var win = false;

			function letterInput(value) {
				if (!done) {
					if (value == "enter") {
						if (positionSquare == word.length) {
							let lettersArray = [];
							let squares = [];
							let keyboardElements = [];
							let lettersColoured = {
								A: 0,
								B: 0,
								C: 0,
								D: 0,
								E: 0,
								F: 0,
								G: 0,
								H: 0,
								I: 0,
								J: 0,
								K: 0,
								L: 0,
								M: 0,
								N: 0,
								O: 0,
								P: 0,
								Q: 0,
								R: 0,
								S: 0,
								T: 0,
								U: 0,
								V: 0,
								W: 0,
								X: 0,
								Y: 0,
								Z: 0,
							};

							// (1) get letters
							for (let i = 0; i < word.length; i++) {
								squares[i] = document.querySelector(`#row${positionRow}square${i}`);
								squares[i].classList.remove("active");
								lettersArray.push(squares[i].innerHTML);

								keyboardElements[i] = document.querySelector(`#${lettersArray[i]}`);
							}

							// (2) CORRECT
							for (let i = 0; i < word.length; i++) {
								if (lettersArray[i] == word[i]) {
									squares[i].classList.add("correct");
									if (keyboardElements[i].classList.contains("present")) keyboardElements[i].classList.remove("present");
									keyboardElements[i].classList.add("correct");

									lettersColoured[lettersArray[i]]++;
								}
							}

							// (3) PRESENT
							for (let i = 0; i < word.length; i++) {
								if (word.includes(lettersArray[i])) {
									if (letters[lettersArray[i]] > lettersColoured[lettersArray[i]]) {
										if (squares[i].classList.length == 0) {
											squares[i].classList.add("present");
											lettersColoured[lettersArray[i]]++;
										}
										if (!keyboardElements[i].classList.contains("correct")) keyboardElements[i].classList.add("present");
									} else {
										if (squares[i].classList.length == 0) squares[i].classList.add("absent");

										lettersColoured[lettersArray[i]]++;
									}
								}
							}

							// (4) ABSENT
							for (let i = 0; i < word.length; i++) {
								if (!word.includes(lettersArray[i])) {
									squares[i].classList.add("absent");
									keyboardElements[i].classList.add("absent");

									lettersColoured[lettersArray[i]]++;
								}
							}

							if (lettersArray.join("") == word || positionRow == word.length) {
								done = true;
								if (lettersArray.join("") == word) {
									win = true;
									if (invalidWord) {
										end(true);
										document.querySelector("title").innerHTML = `wordlelele (?!)`;
									} else {
										end(true);
										document.querySelector("title").innerHTML = `wordlelele (success)`;
									}
								} else {
									if (invalidWord) {
										end(true);
										document.querySelector("title").innerHTML = `wordlelele (?!)`;
									} else {
										end(false);
										document.querySelector("title").innerHTML = `wordlelele (fail)`;
									}
								}
							} else {
								document.querySelector("title").innerHTML = `wordlelele (${positionRow + 2}/${word.length + 1})`;
							}

							positionRow++;
							positionSquare = 0;
						}
					} else if (value == "←") {
						if (positionSquare > 0) {
							let element = document.querySelector(`#row${positionRow}square${positionSquare - 1}`);
							element.innerHTML = "";
							element.classList.remove("active");
							positionSquare--;
						}
					} else {
						if (positionSquare < word.length) {
							let element = document.querySelector(`#row${positionRow}square${positionSquare}`);
							element.innerHTML = value;
							element.classList.add("active");
							positionSquare++;
						}
					}
				}
			}

			// 4: win / lose (set next word / you dumb)
			const winMessages = [
				"Congratulations!",
				"Yippee!",
				"Yay!",
				"Incredible!",
				"Amazing!",
				"Wow!",
				"Excellent!",
				"Awesome!",
				"Super!",
				"Fantastic!",
				"Wonderful!",
				"Bingo!",
				"Way to go!",
				"Great!",
				"Brilliant!",
				"Splendid!",
			];

			function end(win) {
				if (win) {
					document.querySelector(".done p:first-child").innerHTML = "← back";
					if (!invalidWord) {
						document.querySelector(".done h2").innerHTML = winMessages[Math.floor(Math.random() * winMessages.length)];
						document.querySelector(".done p:nth-child(3)").innerHTML = "You did it.";
						document.querySelector("#shareButton").classList.remove("hide");
					} else {
						document.querySelector(".done h2").innerHTML = "Sorry, the word in the database was invalid.";
						document.querySelector(".done p:nth-child(3)").innerHTML = "Please change the word to something acceptable.";
					}

					document.querySelector(".done p:first-child").addEventListener("click", (e) => {
						document.querySelector(".done").classList.remove("show");
						document.querySelector(".guesses").classList.remove("hide");
					});
					document.querySelector("#nextWordSubmit").addEventListener("click", (e) => {
						setNextWord(document.querySelector("input").value.toLowerCase());
					});
					document.querySelector("#shareButton").addEventListener("click", (e) => {
						share();
					});
					document.querySelector("#enter").addEventListener("click", (e) => {
						document.querySelector(".guesses").classList.add("hide");
						document.querySelector(".done").classList.add("show");
						document.querySelector("#nextWordInput").focus();
					});
					document.addEventListener("keydown", (e) => {
						if (e.keyCode == 13) {
							if (document.activeElement == document.querySelector("#doneActionButton")) {
								document.querySelector(".done").classList.remove("show");
								document.querySelector(".guesses").classList.remove("hide");
							} else if (
								document.activeElement == document.querySelector("#nextWordInput") ||
								document.activeElement == document.querySelector("#nextWordSubmit")
							) {
								setNextWord(document.querySelector("input").value.toLowerCase());
							} else if (document.activeElement == document.querySelector("#shareButton")) {
								share();
							} else if (document.activeElement == document.querySelector("body")) {
								console.log(document.activeElement);
								document.querySelector(".guesses").classList.add("hide");
								document.querySelector(".done").classList.add("show");
								document.querySelector("#nextWordInput").focus();
							}
						}
						if (e.keyCode == 27) {
							document.querySelector(".done").classList.remove("show");
							document.querySelector(".guesses").classList.remove("hide");
						}
					});
				} else {
					document.querySelector(".done p:first-child").innerHTML = "← back";
					document.querySelector(".done h2").innerHTML = ":(";
					document.querySelector(".done p:nth-child(3)").innerHTML = `Better luck next time.<br />The word was &ldquo;${word.toLowerCase()}&rdquo;`;
					document.querySelector("#shareButton").classList.remove("hide");

					document.querySelector(".done p:first-child").addEventListener("click", (e) => {
						document.querySelector(".done").classList.remove("show");
						document.querySelector(".guesses").classList.remove("hide");
					});
					document.querySelector("#nextWordSubmit").addEventListener("click", (e) => {
						setNextWord(document.querySelector("input").value.toLowerCase());
					});
					document.querySelector("#shareButton").addEventListener("click", (e) => {
						share();
					});
					document.querySelector("#enter").addEventListener("click", (e) => {
						document.querySelector(".guesses").classList.add("hide");
						document.querySelector(".done").classList.add("show");
						document.querySelector("#nextWordInput").focus();
					});
					document.addEventListener("keydown", (e) => {
						if (e.keyCode == 13) {
							if (document.activeElement == document.querySelector("#doneActionButton")) {
								document.querySelector(".done").classList.remove("show");
								document.querySelector(".guesses").classList.remove("hide");
							} else if (
								document.activeElement == document.querySelector("#nextWordInput") ||
								document.activeElement == document.querySelector("#nextWordSubmit")
							) {
								setNextWord(document.querySelector("input").value.toLowerCase());
							} else if (document.activeElement == document.querySelector("#shareButton")) {
								share();
							} else if (document.activeElement == document.querySelector("body")) {
								document.querySelector(".guesses").classList.add("hide");
								document.querySelector(".done").classList.add("show");
								document.querySelector("#nextWordInput").focus();
							}
						}
						if (e.keyCode == 27) {
							document.querySelector(".done").classList.remove("show");
							document.querySelector(".guesses").classList.remove("hide");
						}
					});
				}

				setTimeout(() => {
					document.querySelector(".guesses").classList.add("hide");
					document.querySelector(".done").classList.add("show");
					document.querySelector("#nextWordInput").focus();
				}, 2000);
			}

			// 5. set next word in database
			var setWord;
			async function setNextWord(word) {
				word = word.replaceAll(" ", "");
				const db = getDatabase();

				if (/^[a-zA-Z]{1,20}$/.test(word)) {
					setWord = word.toUpperCase();

					await set(ref(db, "wordlelele/lastUpdated"), Date.now());
					await set(ref(db, "wordlelele/word"), word);

					document.querySelector("#nextWordStatus").classList.remove("hide");
					document.querySelector("#nextWordStatus").classList.remove("orange");
					document.querySelector("#nextWordStatus").classList.add("blue");
					document.querySelector("#nextWordStatus").innerHTML = `Successfully set the next word to &ldquo;${word}&rdquo;`;
				} else {
					document.querySelector("#nextWordStatus").classList.remove("hide");
					document.querySelector("#nextWordStatus").classList.remove("blue");
					document.querySelector("#nextWordStatus").classList.add("orange");
					document.querySelector("#nextWordStatus").innerHTML = `ERROR: invalid word`;
				}

				document.querySelector("#nextWordInput").blur(); // does this work on mobile
			}

			// 6. share (copy to clipboard)
			function share() {
				var guesses = "";
				document.querySelectorAll(".guesses div div").forEach((letter) => {
					if (letter.innerHTML != "") {
						if (letter.id.substring(letter.id.length - 1) == 0 && letter.id.substring(letter.id.length - 2, letter.id.length - 1) != 1) guesses += "\n";
						if (letter.classList.contains("correct")) guesses += "🟦";
						if (letter.classList.contains("present")) guesses += "🟧";
						if (letter.classList.contains("absent")) guesses += "⬛";
					}
				});

				var finalMessage;
				if (setWord == undefined || word == setWord) {
					if (win) finalMessage = `wordlelele — (not yet changed) in ${positionRow}/${word.length + 1}${guesses}\nhttps://pinniped.page/w`;
					else finalMessage = `wordlelele — (not yet changed) in N/A${guesses}\nhttps://pinniped.page/w`;
				} else {
					if (win) finalMessage = `wordlelele — ${word} in ${positionRow}/${word.length + 1}${guesses}\nhttps://pinniped.page/w`;
					else finalMessage = `wordlelele — ${word} in N/A${guesses}\nhttps://pinniped.page/w`;
				}

				navigator.clipboard.writeText(finalMessage);

				document.querySelector("#shareButtonStatus").classList.remove("hide");
				setTimeout(() => {
					document.querySelector("#shareButtonStatus").classList.add("hide");
				}, 4000);
			}

			// 7. update lastChangedDisplay
			setInterval(() => {
				var days = 0;
				var hours = 0;
				var minutes = 0;
				var seconds = 0;

				var daysWord = "days";
				var hoursWord = "hours";
				var minutesWord = "minutes";
				var secondsWord = "seconds";

				let timeElapsed = Math.floor((Date.now() - lastUpdated) / 1000);

				days = Math.floor(timeElapsed / (60 * 60 * 24));
				timeElapsed -= days * (60 * 60 * 24);

				hours = Math.floor(timeElapsed / (60 * 60));
				timeElapsed -= hours * (60 * 60);

				minutes = Math.floor(timeElapsed / 60);
				timeElapsed -= minutes * 60;

				seconds = timeElapsed;

				if (days == 1) daysWord = "day";
				if (hours == 1) hoursWord = "hour";
				if (minutes == 1) minutesWord = "minute";
				if (seconds == 1) secondsWord = "second";

				if (isNaN(seconds) || invalidWord) {
					document.querySelector("#lastChangedDisplay").innerHTML = `???`;
				} else {
					document.querySelector(
						"#lastChangedDisplay"
					).innerHTML = `<span class="inline-block">${days} ${daysWord}</span> <span class="inline-block">${hours} ${hoursWord}</span> <span class="inline-block">${minutes} ${minutesWord}</span> <span class="inline-block">${seconds} ${secondsWord}</span>`;
				}
			}, 1000);

			// 8. detect more recent word
			function checkForNewWord() {
				const db = getDatabase();

				onValue(ref(db, "wordlelele/word"), (snapshot) => {
					var newWord = snapshot.val();

					if (snapshot.exists()) {
						newWord = newWord.toUpperCase();

						if (/^[a-zA-Z]{1,20}$/.test(newWord) && newWord != word && newWord != setWord) {
							document.querySelector("#newWordButton").classList.remove("hide");
							document.querySelector("#newWordButton").addEventListener("click", newWordButtonClicked);
						} else {
							document.querySelector("#newWordButton").classList.add("hide");
							document.querySelector("#newWordButton").removeEventListener("click", newWordButtonClicked);
						}
					}
				});
			}

			function newWordButtonClicked() {
				window.location.reload();
			}

			// 9. themes!
			let themeColours = ["252525", "464646", "7d7d7d", "ffffff", "448ccb", "f68e56"];
			function loadThemeFromURL() {
				const query = window.location.search;
				const item = new URLSearchParams(query);
				const theme = item.get("theme");

				if (
					theme == null ||
					theme == "" ||
					!/^[0123456789abcdefABCDEF]{6}-[0123456789abcdefABCDEF]{6}-[0123456789abcdefABCDEF]{6}-[0123456789abcdefABCDEF]{6}-[0123456789abcdefABCDEF]{6}-[0123456789abcdefABCDEF]{6}$/.test(
						theme
					)
				)
					return;

				const colours = theme.split("-");
				document.querySelector(
					"#theme"
				).innerHTML = `:root {--c1: #${colours[0]}; --c2: #${colours[1]}; --c3: #${colours[2]}; --c4: #${colours[3]}; --c5: #${colours[4]}; --c6: #${colours[5]};}`;

				document.querySelector("#c5colour").innerHTML = `&nbsp;#${colours[4]}&nbsp;`;
				document.querySelector("#c6colour").innerHTML = `&nbsp;#${colours[5]}&nbsp;`;
				document.querySelector("#c2colour").innerHTML = `&nbsp;#${colours[1]}&nbsp;`;

				themeColours[0] = colours[0];
				themeColours[1] = colours[1];
				themeColours[2] = colours[2];
				themeColours[3] = colours[3];
				themeColours[4] = colours[4];
				themeColours[5] = colours[5];

				document.querySelector("#themeColour1").value = `#${colours[0]}`;
				document.querySelector("#themeColour2").value = `#${colours[1]}`;
				document.querySelector("#themeColour3").value = `#${colours[2]}`;
				document.querySelector("#themeColour4").value = `#${colours[3]}`;
				document.querySelector("#themeColour5").value = `#${colours[4]}`;
				document.querySelector("#themeColour6").value = `#${colours[5]}`;
			}
			loadThemeFromURL();

			let themeIndex = 0;
			document.querySelectorAll('input[type="color"]').forEach((input) => {
				let thisThemeIndex = themeIndex++;
				input.addEventListener("change", () => {
					themeColours[thisThemeIndex] = input.value.substring(1);

					document.querySelector(
						"#theme"
					).innerHTML = `:root {--c1: #${themeColours[0]}; --c2: #${themeColours[1]}; --c3: #${themeColours[2]}; --c4: #${themeColours[3]}; --c5: #${themeColours[4]}; --c6: #${themeColours[5]};}`;

					window.history.pushState(
						"",
						"",
						`?theme=${themeColours[0]}-${themeColours[1]}-${themeColours[2]}-${themeColours[3]}-${themeColours[4]}-${themeColours[5]}`
					);
				});
			});

			// last: version #
			let version = "1.6.0";
			document.querySelector("#version").innerHTML = `wordlelele v${version} — a project by <a href="../about.html">Obsidian_Seal</a>`;
			console.log(`w | v${version}`);
		</script>
	</body>

	<script src="../files/auto-project-link-target.js" type="module"></script>
</html>
