<!DOCTYPE html>

<html lang="en-CA">
	<head>
		<title>THE GAME OF NUMBERS</title>

		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#4ecdc4" />

		<link rel="icon" href="../images/icon.png" />

		<script src="https://kit.fontawesome.com/c6ef7d4818.js" crossorigin="anonymous"></script>

		<meta property="og:url" content="https://pinniped.page/projects/tgon" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="THE GAME OF NUMBERS" />
		<meta property="og:description" content="It&rsquo;s all a numbers game." />
		<meta property="og:image" content="https://pinniped.page/images/icon.png" />

		<meta name="description" content="It&rsquo;s all a numbers game." />
		<meta
			name="keywords"
			content="pinniped.page, Obsidian_Seal, original, board, game, dice, cards, fun, random, multiplayer, online, code, join, friends, party, silly, weird"
		/>

		<style>
			/* FONTS */

			@font-face {
				font-family: "PP Pangram Sans Rounded";
				font-weight: 400;
				src: url("../files/PPPangramSansRounded-Regular.woff2");
			}
			@font-face {
				font-family: "PP Pangram Sans Rounded";
				font-weight: 700;
				src: url("../files/PPPangramSansRounded-Bold.woff2");
			}

			/* VARIABLES */

			:root {
				--darkest: #181818;
				--dark: #4d4d4d;
				--light: #cecece;
				--lightest: #ebebeb;

				--green-circle: #338637;
				--vibrant-coral-circle: #d13737;
				--blue-circle: #1c407f;

				--green-card: #6ee674;
				--vibrant-coral-card: #ff96ab;
				--blue-card: #5f92ea;

				/* steal the Wplace colours */
			}

			/* ALL ELEMENTS */

			* {
				margin: 0;
				border: 0;
				padding: 0;

				font-family: "PP Pangram Sans Rounded";
				font-weight: 400;
				font-size: 20px;

				-webkit-tap-highlight-color: transparent !important;
			}

			/* ELEMENTS */

			body {
				background-color: var(--darkest);
			}

			b {
				font-weight: 700;
			}

			/* CLASSES */

			.no-select {
				-webkit-user-select: none !important;
				-moz-user-select: none !important;
				-ms-user-select: none !important;
				user-select: none !important;
			}

			.hide,
			.sr-only {
				display: none !important;
			}

			.game-board-panel {
				width: 100dvw;
				height: 100dvh;

				display: flex;
				align-items: center;
				justify-content: center;
			}

			.game-board {
				max-width: 500px;
				max-height: 500px;

				margin: 21px;

				background-color: var(--darkest);

				display: flex;
				flex-wrap: wrap-reverse;
			}

			.game-board-square {
				position: relative;

				width: 10%;
				height: 10%;
				aspect-ratio: 1;

				background-color: var(--light);
				color: var(--dark);

				display: flex;
				align-items: center;
				justify-content: center;

				box-sizing: border-box;
				border: 1px solid var(--darkest);
			}

			.game-board-square-circle {
				position: absolute;

				width: 42px;
				height: 42px;
				box-sizing: border-box;

				border: 5px solid #401a99;
				border-radius: 21px;
			}

			.game-board-square-player-token-container {
				position: absolute;

				display: flex;
				align-items: center;
				justify-content: center;
				flex-wrap: wrap;
				gap: 2px;
			}

			.game-board-square-player-token {
				width: 20px;
				height: 20px;

				border-radius: 10px;

				background-color: #65a5e6;
				/* opacity: 75%; */
			}
		</style>
	</head>

	<body>
		<div class="game-board-panel">
			<div class="game-board"></div>
		</div>
	</body>

	<script type="module">
		"use strict";

		// --- FIREBASE ---

		import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
		import { getDatabase, ref, get, push, set, remove } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";

		const firebaseConfig = {
			apiKey: "AIzaSyAigBAgn7Uhybip_m3P508DIpybb2qdI5g",
			authDomain: "the-pinniped-page.firebaseapp.com",
			databaseURL: "https://the-pinniped-page.firebaseio.com",
			projectId: "the-pinniped-page",
			storageBucket: "the-pinniped-page.appspot.com",
			messagingSenderId: "636989973689",
			appId: "1:636989973689:web:6d938d9588606d803a6768",
		};
		const app = initializeApp(firebaseConfig);
		const database = getDatabase();

		// --- ELEMENT CREATION ---

		function createGameBoard() {
			const gameBoardElement = document.querySelector(".game-board");

			for (let i = 1; i <= 100; i++) {
				const gameBoardSquareElement = document.createElement("div");
				gameBoardSquareElement.classList.add("game-board-square");
				gameBoardSquareElement.innerHTML = i;
				gameBoardElement.append(gameBoardSquareElement);

				if (Math.floor(Math.random() * 10) == 0) {
					const gameBoardSquareCircleElement = document.createElement("div");
					gameBoardSquareCircleElement.classList.add("game-board-square-circle");
					gameBoardSquareCircleElement.style = "border-color: var(--blue-circle)";
					gameBoardSquareElement.append(gameBoardSquareCircleElement);
				}

				const gameBoardSquarePlayerTokenContainer = document.createElement("div");
				gameBoardSquarePlayerTokenContainer.classList.add("game-board-square-player-token-container");
				gameBoardSquareElement.appendChild(gameBoardSquarePlayerTokenContainer);

				if (Math.floor(Math.random() * 5) == 0) {
					const randomNumber = Math.floor(Math.random() * 4) + 1;
					for (let j = 0; j < randomNumber; j++) {
						const gameBoardSquarePlayerTokenElement = document.createElement("div");
						gameBoardSquarePlayerTokenElement.classList.add("game-board-square-player-token");
						gameBoardSquarePlayerTokenContainer.append(gameBoardSquarePlayerTokenElement);
					}
				}
			}
		}
		createGameBoard();

		// --- UTILITIES ---

		const base64Characters = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_";

		function toBase64(base10Number) {
			if (base10Number <= 0) return 0;

			let base64Number = "";
			while (base10Number > 0) {
				base64Number = base64Characters[base10Number % 64] + base64Number;
				base10Number = Math.floor(base10Number / 64);
			}
			return base64Number;
		}

		function fromBase64(base64Number) {
			let index = base64Number.length;
			let base10Number = 0;
			for (let character of base64Number.split("")) {
				base10Number += base64Characters.indexOf(character) * Math.pow(64, --index);
			}
			return base10Number;
		}

		// --- TESTS ---

		// let date = new Date();
		// let now = date.getTime();
		// let playerID = toBase64(now);

		// set(ref(database, `game-of-numbers/${playerID}`), date.toLocaleString())
		// 	.then((success) => {
		// 		document.body.innerHTML = `<i class="fa-jelly fa-regular fa-wand-magic-sparkles"></i> logged in as <b>${playerID}</b><br />close this tab to log out<br /><br /><b>${date.toISOString()}</b>`;
		// 	})
		// 	.catch((error) => {
		// 		console.error(error);
		// 		document.body.innerHTML = `<i class="fa-jelly fa-regular fa-skull"></i> error logging in!<br />(${playerID})<br /><br /><b>${date.toISOString()}</b>`;
		// 	});

		// addEventListener("beforeunload", () => {
		// 	remove(ref(database, `game-of-numbers/${playerID}`))
		// 		.then((success) => {})
		// 		.catch((error) => {
		// 			console.error(error);
		// 		});
		// });
	</script>

	<script src="../files/auto-project-link-target.js" type="module"></script>
</html>
